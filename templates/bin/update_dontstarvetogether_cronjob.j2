#!/bin/bash


main() {
  stop_services
  update
  start_services
}


update() {
  sudo -u steam sh -c '/home/steam/cmd/steamcmd.sh +runscript /home/steam/apps/dontstarvetogether/bin/update > /var/log/update_dontstarvetogether.log 2>&1'
  sudo -u steam sh -c "echo $? > /var/log/update_dontstarvetogether.ret"
  /home/steam/cmd/steamcmd.sh +runscript /home/steam/apps/dontstarvetogether/bin/update 
}


stop_services() {
  for service in /etc/init.d/dst-*; do
    $service stop
  done
}


start_services() {
  for service in /etc/init.d/dst-*; do
    $service start
  done
}


main
